category_preprocess/truyền nhiễm.json 6
category_preprocess/ngoại.json 2
category_preprocess/lâm sàng cận lâm sàng.json 0
category_preprocess/nhi.json 3
category_preprocess/sản.json 5
category_preprocess/nội.json 4
category_preprocess/liên khoa mắt tai mũi họng răng hàm mặt da liễu.json 1
21000 21000 6
2184 2184 6
<class 'scipy.sparse.csr.csr_matrix'>
<class 'numpy.ndarray'>
(21000, 15517) (2184, 15517)
(21000, 7) (2184, 7)
2020-09-19 17:06:53.132719: W tensorflow/stream_executor/platform/default/dso_loader.cc:59] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2020-09-19 17:06:53.132746: W tensorflow/stream_executor/cuda/cuda_driver.cc:312] failed call to cuInit: UNKNOWN ERROR (303)
2020-09-19 17:06:53.132764: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (namlh): /proc/driver/nvidia/version does not exist
2020-09-19 17:06:53.132928: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN)to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2020-09-19 17:06:53.158309: I tensorflow/core/platform/profile_utils/cpu_utils.cc:104] CPU Frequency: 3593185000 Hz
2020-09-19 17:06:53.158752: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x3cd87e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-19 17:06:53.158794: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense (Dense)                (None, 256)               3972608   
_________________________________________________________________
dropout (Dropout)            (None, 256)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 32)                8224      
_________________________________________________________________
dropout_1 (Dropout)          (None, 32)                0         
_________________________________________________________________
dense_2 (Dense)              (None, 8)                 264       
_________________________________________________________________
dense_3 (Dense)              (None, 7)                 63        
=================================================================
Total params: 3,981,159
Trainable params: 3,981,159
Non-trainable params: 0
_________________________________________________________________
2020-09-19 17:06:53.763389: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 1303428000 exceeds 10% of free system memory.
Epoch 1/20
1311/1313 [============================>.] - ETA: 0s - loss: 1.4918 - accuracy: 0.45352020-09-19 17:07:07.221395: W tensorflow/core/framework/cpu_allocator_impl.cc:81] Allocation of 135556512 exceeds 10% of free system memory.
1313/1313 [==============================] - 13s 10ms/step - loss: 1.4916 - accuracy: 0.4536 - val_loss: 1.0908 - val_accuracy: 0.7042
Epoch 2/20
1313/1313 [==============================] - 13s 10ms/step - loss: 1.1225 - accuracy: 0.6320 - val_loss: 1.0173 - val_accuracy: 0.7175
Epoch 3/20
1313/1313 [==============================] - 13s 10ms/step - loss: 0.9621 - accuracy: 0.6957 - val_loss: 0.9627 - val_accuracy: 0.7303
Epoch 4/20
1313/1313 [==============================] - 13s 10ms/step - loss: 0.8573 - accuracy: 0.7350 - val_loss: 0.9163 - val_accuracy: 0.7477
Epoch 5/20
1313/1313 [==============================] - 13s 10ms/step - loss: 0.7892 - accuracy: 0.7526 - val_loss: 0.9425 - val_accuracy: 0.7376
Epoch 6/20
1313/1313 [==============================] - 13s 10ms/step - loss: 0.7252 - accuracy: 0.7756 - val_loss: 0.9201 - val_accuracy: 0.7454
Epoch 7/20
1313/1313 [==============================] - 13s 10ms/step - loss: 0.6819 - accuracy: 0.7901 - val_loss: 0.9514 - val_accuracy: 0.7422
Epoch 8/20
1313/1313 [==============================] - 13s 10ms/step - loss: 0.6354 - accuracy: 0.8068 - val_loss: 0.9613 - val_accuracy: 0.7386
Epoch 9/20
1313/1313 [==============================] - 13s 10ms/step - loss: 0.6118 - accuracy: 0.8128 - val_loss: 0.9475 - val_accuracy: 0.7427
Epoch 10/20
1313/1313 [==============================] - 13s 10ms/step - loss: 0.5761 - accuracy: 0.8246 - val_loss: 1.0113 - val_accuracy: 0.7312
Epoch 11/20
1313/1313 [==============================] - 13s 10ms/step - loss: 0.5487 - accuracy: 0.8296 - val_loss: 1.0420 - val_accuracy: 0.7372
Epoch 12/20
1313/1313 [==============================] - 13s 10ms/step - loss: 0.5356 - accuracy: 0.8327 - val_loss: 1.0415 - val_accuracy: 0.7285
Epoch 13/20
1313/1313 [==============================] - 13s 10ms/step - loss: 0.4986 - accuracy: 0.8453 - val_loss: 1.0637 - val_accuracy: 0.7299
Epoch 14/20
1313/1313 [==============================] - 13s 10ms/step - loss: 0.4711 - accuracy: 0.8533 - val_loss: 1.1699 - val_accuracy: 0.7074
Epoch 15/20
1313/1313 [==============================] - 13s 10ms/step - loss: 0.4679 - accuracy: 0.8543 - val_loss: 1.1266 - val_accuracy: 0.7193
Epoch 16/20
1313/1313 [==============================] - 13s 10ms/step - loss: 0.4464 - accuracy: 0.8631 - val_loss: 1.1440 - val_accuracy: 0.7299
Epoch 17/20
1313/1313 [==============================] - 13s 10ms/step - loss: 0.4345 - accuracy: 0.8662 - val_loss: 1.1392 - val_accuracy: 0.7189
Epoch 18/20
1313/1313 [==============================] - 13s 10ms/step - loss: 0.4188 - accuracy: 0.8693 - val_loss: 1.1814 - val_accuracy: 0.7225
Epoch 19/20
1313/1313 [==============================] - 13s 10ms/step - loss: 0.4130 - accuracy: 0.8705 - val_loss: 1.1903 - val_accuracy: 0.7143
Epoch 20/20
1313/1313 [==============================] - 13s 10ms/step - loss: 0.3966 - accuracy: 0.8769 - val_loss: 1.2266 - val_accuracy: 0.7170

